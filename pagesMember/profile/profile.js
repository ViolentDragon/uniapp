"use strict";const e=require("../../common/vendor.js"),a=require("../../services/profile.js"),i=require("../../stores/modules/member.js");require("../../utils/http.js"),require("../../stores/index.js"),require("../../stores/modules/address.js");const l=e.defineComponent({__name:"profile",setup(l){const{safeAreaInsets:o}=e.index.getSystemInfoSync(),t=i.useMemberStore(),n=e.ref({}),r=()=>{e.index.chooseMedia({count:1,mediaType:["image"],success:a=>{const{tempFilePath:i}=a.tempFiles[0];e.index.uploadFile({url:"/member/profile/avatar",fileType:"image",filePath:i,name:"file",success:a=>{if(200===a.statusCode){const{avatar:i}=JSON.parse(a.data).result;n.value.avatar=i,t.profile.avatar=i,e.index.showToast({icon:"success",title:"修改成功"})}else e.index.showToast({icon:"error",title:"出现错误"})}})}})},u=e=>{n.value.gender=e.detail.value},s=e=>{n.value.birthday=e.detail.value};let d=["","",""];const v=e=>{n.value.fullLocation=e.detail.value.join(" "),d=e.detail.code},c=async()=>{const{nickname:i,gender:l,birthday:o}=n.value,r=await a.putMemberProfileService({nickname:i,gender:l,birthday:o,provinceCode:d[0],cityCode:d[1],countyCode:d[2]});t.profile.nickname=r.result.nickname,t.profile.gender=r.result.gender,t.profile.birthday=r.result.birthday,t.profile.profession=n.value.profession,e.index.showToast({title:"保存成功",icon:"none"}),setTimeout((()=>{e.index.navigateBack()}),300)};return e.onLoad((()=>{(async()=>{const e=await a.getProfileService();n.value=e.result})()})),(a,i)=>{var l,t,d,f,m,p,h,y,b,g,x,j;return e.e({a:(null==(l=e.unref(o))?void 0:l.top)+"px",b:null==(t=n.value)?void 0:t.avatar,c:e.o(r),d:e.t(null==(d=n.value)?void 0:d.account),e:n.value.nickname,f:e.o((e=>n.value.nickname=e.detail.value)),g:"男"===(null==(f=n.value)?void 0:f.gender),h:"女"===(null==(m=n.value)?void 0:m.gender),i:e.o(u),j:null==(p=n.value)?void 0:p.birthday},(null==(h=n.value)?void 0:h.birthday)?{k:e.t(null==(y=n.value)?void 0:y.birthday)}:{},{l:new Date,m:null==(b=n.value)?void 0:b.birthday,n:e.o(s),o:null==(g=n.value)?void 0:g.fullLocation},(null==(x=n.value)?void 0:x.fullLocation)?{p:e.t(n.value.fullLocation)}:{},{q:["广东省","广州市","天河区"],r:e.o(v),s:null==(j=n.value)?void 0:j.profession,t:e.o(c)})}}});wx.createPage(l);
