"use strict";const e=require("../../../../common/vendor.js");require("../../../../stores/index.js");const t=require("../../../../services/cart.js"),o=require("../../../../stores/modules/member.js");if(require("../../../../stores/modules/address.js"),require("../../../../utils/http.js"),!Array){(e.resolveComponent("vk-data-input-number-box")+e.resolveComponent("uni-swipe-action-item")+e.resolveComponent("uni-swipe-action")+e.resolveComponent("XtxGuess"))()}Math||((()=>"../../../../components/vk-data-input-number-box/vk-data-input-number-box.js")+(()=>"../../../../node-modules/@dcloudio/uni-ui/lib/uni-swipe-action-item/uni-swipe-action-item.js")+(()=>"../../../../node-modules/@dcloudio/uni-ui/lib/uni-swipe-action/uni-swipe-action.js")+(()=>"../../../../components/XtxGuess.js"))();const r=e.defineComponent({__name:"CartMain",setup(r){const n=o.useMemberStore(),s=e.ref([]),u=async()=>{const e=await t.getShoppingCartService();s.value=e.result},i=e=>{t.alterCartProService(e.index,{count:e.value})},c=e.computed((()=>s.value.length&&s.value.every((e=>e.selected)))),a=()=>{const e=!c.value;s.value.forEach((t=>t.selected=e)),t.alterAllSelectedService({selected:e})},d=e.computed((()=>s.value.filter((e=>e.selected)))),l=e.computed((()=>d.value.reduce(((e,t)=>e+t.count),0))),m=e.computed((()=>d.value.reduce(((e,t)=>e+t.count*t.price),0).toFixed(2))),p=()=>{if(0===l.value)return e.index.showToast({title:"请至少选择一件商品",icon:"error"});e.index.navigateTo({url:"/pagesOrder/order/order"})};return e.onShow((()=>{n.profile&&u()})),(o,r)=>e.e({a:e.unref(n).profile},e.unref(n).profile?e.e({b:s.value.length>0},s.value.length>0?{c:e.f(s.value,((o,r,n)=>({a:o.selected?1:"",b:e.o((e=>(e=>{e.selected=!e.selected,t.alterCartProService(e.skuId,{selected:e.selected})})(o)),o.skuId),c:o.picture,d:e.t(o.name),e:e.t(o.attrsText),f:e.t(o.nowPrice),g:`/pages/goods/goods?id=${o.id}`,h:e.o(i,o.skuId),i:"ea6422fc-2-"+n+",ea6422fc-1-"+n,j:e.o((e=>o.count=e),o.skuId),k:e.p({min:1,max:o.stock,index:o.skuId,modelValue:o.count}),l:e.o((r=>{return n=o.skuId,void e.index.showModal({content:"是否删除",confirmColor:"#27BA9B",success:async e=>{e.confirm&&(await t.deleteShoppingCartService({ids:[n]}),u())}});var n}),o.skuId),m:o.skuId,n:"ea6422fc-1-"+n+",ea6422fc-0"})))}:{},{d:e.unref(c)?1:"",e:e.o(a),f:e.t(e.unref(m)),g:e.t(e.unref(l)),h:e.unref(d).length?"":1,i:e.o(p)}):{},{j:e.sr("guessRef","ea6422fc-3")})}});wx.createComponent(r);
